@startuml
!theme spacelab
title Improved Remote Control Activity Diagram

partition "User (Mobile App)" {
    start
    :User selects remote command;
}

partition "System (Backend & Vehicle)" {
    switch (Selected Remote Command?)
    case (Lock / Unlock Doors)
        :Send Lock/Unlock command to Vehicle;
        if (Command successful?) then (yes)
            :Receive success confirmation;
        else (no)
            :Receive failure response;
            note right: Communication error or system fault
        endif

    case (Climate Preconditioning)
        :User configures Climate Settings\n(Temp, Seats, Defrosters, etc.);
        if (Is vehicle plugged in?) then (no)
            :Display battery consumption warning;
            if (User confirms to proceed?) then (no)
                :Cancel climate action;
                stop
            else (yes)
                ' Proceed to send command
            endif
        endif
        :Send climate command with settings;
        if (Command successful?) then (yes)
            :Receive success confirmation;
        else (no)
            :Receive failure response;
            note right: e.g., Low battery, System fault
        endif

    case (Open Trunk)
        :User selects Front or Rear Trunk;
        if (Is vehicle stationary?) then (yes)
            :Send Open Trunk command;
            if (Command successful?) then (yes)
                :Receive success confirmation;
            else (no)
                :Receive failure response;
            endif
        else (no)
            :Reject command;
        endif

    case (Honk Horn & Flash Lights)
        :Send Honk & Flash command;
        if (Command successful?) then (yes)
            :Receive success confirmation;
        else (no)
            :Receive failure response;
        endif

    endswitch
}

partition "User (Mobile App)" {
    switch (Received System Response?)
    case (Lock/Unlock Success)
        :Provide haptic feedback;
        :Display updated door status;

    case (Climate Success)
        :Display updated climate status;

    case (Trunk Success)
        :Display updated trunk status;

    case (Honk/Flash Success)
        :Display "Command Sent" confirmation;

    case (Vehicle Not Stationary)
        :Display Error: "Vehicle must be stationary";

    case (Generic Failure)
        :Display "Command Failed" error message;

    endswitch

    :End remote session;
    stop
}

@enduml