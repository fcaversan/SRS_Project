@startuml

skinparam classAttributeIconSize 0
hide empty members

' --- Presentation Layer ---

class HomeScreen {
  + updateView(status: VehicleStatusDTO)
}

class HomeScreenPresenter {
  + loadVehicleStatus()
}

class VehicleRepresentation {
  - vehicleImage: Image
  ' IMPROVED: Added an explicit method to show how the view is updated with the DTO data.
  + update(imageUrl: String)
  + render()
}

' --- Data & API Layer ---

class VehicleAPIClient {
  + fetchVehicleStatus(prefs: UserPreferences): VehicleStatusDTO
}

class UserPreferencesRepository {
  + getPreferences(): UserPreferences
}

' --- Data Transfer & Domain Models ---

class VehicleStatusDTO <<DTO>> {
  ' FR-HSS-001
  + stateOfCharge: float
  ' FR-HSS-003
  + estimatedRange: String
  ' FR-HSS-005
  + lockStatus: LockStatus
  ' FR-HSS-006
  + cabinTemperature: String
  ' FR-HSS-007
  + isClimateControlActive: boolean
  ' FR-HSS-008
  + vehicleImageUrl: String
  + isStale: boolean
  + lastUpdated: Timestamp
}

' IMPROVED: Added note to explain design decision for String types, as recommended by QA.
note right of VehicleStatusDTO
  `estimatedRange` and `cabinTemperature`
  are Strings because the backend API
  handles all unit conversion and formatting
  (e.g., "250 mi", "72Â°F") based on
  user preferences.
end note

class UserPreferences {
  - preferredDistanceUnit: DistanceUnit
  - preferredTemperatureUnit: TemperatureUnit
  + getPreferredDistanceUnit(): DistanceUnit
  + getPreferredTemperatureUnit(): TemperatureUnit
}

' --- Data Types and Enums ---

enum LockStatus {
  LOCKED
  UNLOCKED
}

enum DistanceUnit {
  MILES
  KILOMETERS
}

enum TemperatureUnit {
  CELSIUS
  FAHRENHEIT
}

class Timestamp <<DataType>>

' --- Relationships ---

' Presentation Layer
HomeScreenPresenter "1" o-- "1" HomeScreen : controls
HomeScreen "1" *-- "1" VehicleRepresentation : composes
HomeScreen ..> VehicleStatusDTO : displays
' IMPROVED: Shows that HomeScreen uses the DTO to update the vehicle image component.
HomeScreen ..> VehicleRepresentation : updates >

' Presenter to Data/API Layer
HomeScreenPresenter ..> VehicleAPIClient
HomeScreenPresenter ..> UserPreferencesRepository

' Data/API Layer & Domain
' IMPROVED: Standardized dependency notation as per QA recommendation.
VehicleAPIClient ..> UserPreferences
VehicleAPIClient ..> VehicleStatusDTO : <<create>>
UserPreferencesRepository ..> UserPreferences : <<create>>

' Model/DTO Data Types
VehicleStatusDTO --> "1" LockStatus
VehicleStatusDTO ..> Timestamp
UserPreferences --> "1" DistanceUnit
UserPreferences --> "1" TemperatureUnit

@enduml