@startuml

skinparam classAttributeIconSize 0
hide empty members

' --- Presentation Layer ---

class HomeScreen {
  + updateView(status: VehicleStatusDTO)
}

class HomeScreenPresenter {
  + loadVehicleStatus()
}

class VehicleRepresentation {
  - vehicleImage: Image
  + render()
}

' --- Data & API Layer ---

class VehicleAPIClient {
  + fetchVehicleStatus(prefs: UserPreferences): VehicleStatusDTO
}

' IMPROVED: Added to clarify how UserPreferences are obtained
class UserPreferencesRepository {
  + getPreferences(): UserPreferences
}

' --- Data Transfer & Domain Models ---

class VehicleStatusDTO <<DTO>> {
  ' FR-HSS-001
  + stateOfCharge: float
  ' FR-HSS-003
  + estimatedRange: String
  ' FR-HSS-005
  + lockStatus: LockStatus
  ' FR-HSS-006 & IMPROVED: Data type changed to String per QA feedback to match formatted API payload (e.g., "72Â°F")
  + cabinTemperature: String
  ' FR-HSS-007
  + isClimateControlActive: boolean
  ' FR-HSS-008
  + vehicleImageUrl: String
  + isStale: boolean
  + lastUpdated: Timestamp
}

class UserPreferences {
  - preferredDistanceUnit: DistanceUnit
  - preferredTemperatureUnit: TemperatureUnit
  + getPreferredDistanceUnit(): DistanceUnit
  + getPreferredTemperatureUnit(): TemperatureUnit
}

' --- Data Types and Enums ---

enum LockStatus {
  LOCKED
  UNLOCKED
}

enum DistanceUnit {
  MILES
  KILOMETERS
}

enum TemperatureUnit {
  CELSIUS
  FAHRENHEIT
}

class Timestamp <<DataType>>

' --- Relationships ---

' Presentation Layer
HomeScreenPresenter "1" o-- "1" HomeScreen : controls
HomeScreen "1" *-- "1" VehicleRepresentation : composes
HomeScreen ..> VehicleStatusDTO : displays

' Presenter to Data/API Layer
HomeScreenPresenter ..> VehicleAPIClient : uses
' IMPROVED: Shows Presenter's dependency on a repository to fetch preferences, addressing a logic gap.
HomeScreenPresenter ..> UserPreferencesRepository : uses

' Data/API Layer
VehicleAPIClient ..> UserPreferences : uses >
VehicleAPIClient ..> VehicleStatusDTO : creates >
' IMPROVED: Shows the repository is the source of the UserPreferences object.
UserPreferencesRepository ..> UserPreferences : creates >

' Model/DTO Data Types
VehicleStatusDTO --> "1" LockStatus
VehicleStatusDTO ..> Timestamp
UserPreferences --> "1" DistanceUnit
UserPreferences --> "1" TemperatureUnit

@enduml