@startuml
!theme sketchy-outline

title Home_Screen_Vehicle_Status_v1 Interactions

autonumber

actor "User" as User
participant "App" as App
participant "API" as API
database "DB" as DB

User -> App: Launches or foregrounds the application
activate App

App -> App: Initiate fetch for latest vehicle status

alt Happy Path: Successful Status Fetch

    App -> API: GET /vehicle/status
    activate API

    API -> DB: Query for latest vehicle status record
    activate DB
    DB --> API: Return vehicle status data \n(SoC, range, lock_status, temp, etc.)
    deactivate DB

    API --> App: 200 OK \n{ "soc": 85, "range": 250, "locked": true, ... }
    deactivate API

    App -> App: Parse vehicle status data
    App -> User: Display updated Home Screen \n(SoC, range, lock status, temp, etc.) \n(FR-HSS-001 to FR-HSS-008)

else Sad Path: API Error or Stale Data from Server

    App -> API: GET /vehicle/status
    activate API

    alt API cannot reach database
        API -> DB: Query for latest vehicle status record
        activate DB
        DB --> API: Error / Timeout
        deactivate DB
        API --> App: 500 Internal Server Error
    else Data in DB is stale (older than 60s per NFR-PERF-002)
        API -> DB: Query for latest vehicle status record
        activate DB
        DB --> API: Return stale vehicle status data
        deactivate DB
        API --> App: 200 OK with stale data flag \n{ "status": "stale", "last_updated": "...", ... }
    end
    
    deactivate API

    App -> App: Display "Failed to update status" message
    App -> App: Display cached vehicle data with "last updated" timestamp \n(per NFR-REL-002)
    App -> User: Show Home Screen with cached data and error indicator

else Sad Path: No Network Connectivity on Device

    App -> App: Detects no network connection
    App -> User: Display "Device is Offline" message
    App -> App: Display cached vehicle data with "last updated" timestamp \n(per NFR-REL-002)
    App -> User: Show Home Screen with cached data and offline indicator
    
end

deactivate App

@enduml