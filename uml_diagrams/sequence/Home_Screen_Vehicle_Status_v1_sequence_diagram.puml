@startuml
' v1.0
!theme materia

title Home_Screen_Vehicle_Status_v1 Interactions

autonumber

actor "User" as User
participant "App" as App
participant "API" as API
database "DB" as DB

User -> App: Opens application / Navigates to Home Screen
activate App

App -> API: GET /vehicle/{id}/status
activate API

alt Successful API Response

    API -> DB: Query for latest vehicle telemetry data\n(SoC, consumption trends, temps, lock status, climate status)
    activate DB

    alt Fresh Vehicle Data Available
        DB --> API: Return latest vehicle telemetry data
        deactivate DB

        API -> API: Calculate estimated range\n(based on SoC, consumption, ambient temp)

        API --> App: 200 OK - VehicleStatusResponse\n{\n  soc: 85,\n  range: "250 mi",\n  isLocked: true,\n  cabinTemp: "72Â°F",\n  isClimateOn: false,\n  ... \n}
        deactivate API

        App -> App: Render Home Screen UI components
        App --> User: Display full vehicle status:\n- SoC Percentage (FR-HSS-001)\n- Visual Battery Level (FR-HSS-002)\n- Estimated Range (FR-HSS-003)\n- Lock Status (FR-HSS-005)\n- Cabin Temperature (FR-HSS-006)\n- Climate Status (FR-HSS-007)\n- Vehicle Graphic (FR-HSS-008)

    else Vehicle Data is Stale (e.g., vehicle offline)
        DB --> API: Return last known data with timestamp
        deactivate DB

        API --> App: 200 OK - StaleVehicleStatusResponse\n{\n  last_updated: "2 hours ago",\n  last_known_status: { ... }\n}
        deactivate API

        App -> App: Render Home Screen with stale data indicator
        App --> User: Display last known vehicle status\nwith a message "Status last updated 2 hours ago"

    end

else API Call Fails (Network Error / Server Error)
    API --> App: 503 Service Unavailable / Network Timeout
    deactivate API

    App -> App: Handle API error
    App --> User: Display error message:\n"Unable to fetch latest vehicle status.\nPlease check your connection."

end

deactivate App

@enduml