@startuml
!theme plain

title Remote_Controls_v1 Interactions
autonumber

actor "User" as User
participant "App" as App
participant "API" as API
database "DB" as DB

alt Lock / Unlock Doors (FR-RMC-001, FR-RMC-002, FR-RMC-010)

    User -> App: Taps "Lock" or "Unlock"
    App -> API: POST /vehicles/{id}/command\n{"command": "door_lock/unlock"}

    alt Successful Command
        API -> API: Validate request and send command to vehicle
        API -> DB: UPDATE vehicles SET is_locked = [true/false] WHERE id = ?
        DB --> API: Success
        API --> App: 200 OK
        App -> App: Provide Haptic Feedback (FR-RMC-010)
        App --> User: Display "Vehicle Locked/Unlocked"
    else API Error
        API --> App: 503 Service Unavailable
        App --> User: Display "Command Failed. Please try again."
    end

else Activate Climate Control (FR-RMC-003, FR-RMC-004, FR-RMC-007)

    User -> App: Taps "Start Climate" and sets temperature
    App -> API: GET /vehicles/{id}/state
    API -> DB: SELECT is_plugged_in FROM vehicles WHERE id = ?
    DB --> API: Vehicle State (e.g., is_plugged_in: false)
    API --> App: 200 OK with State

    alt Vehicle is not plugged in (FR-RMC-007)
        App --> User: Display Warning:\n"Vehicle is not plugged in.\nThis will consume battery range. Continue?"
        User -> App: Confirms "Continue"
    end

    App -> API: POST /vehicles/{id}/command\n{"command": "hvac_start", "temp": 21}

    alt Successful Command
        API -> API: Validate request and send command to vehicle
        API -> DB: UPDATE vehicles SET hvac_status = 'on', target_temp = 21 WHERE id = ?
        DB --> API: Success
        API --> App: 200 OK
        App --> User: Display "Climate Control Activated"
    else Command Failed
        API --> App: 503 Service Unavailable
        App --> User: Display "Command Failed. Please try again."
    end

else Activate Seat/Wheel Heaters or Defrosters (FR-RMC-005, FR-RMC-006)

    User -> App: Taps "Heated Seat On" or "Defroster On"
    App -> API: POST /vehicles/{id}/command\n{"command": "heated_seat_on", "level": 3}

    alt Successful Command
        API -> API: Validate request and send command to vehicle
        API -> DB: UPDATE vehicles SET heated_seat_status = 'on' WHERE id = ?
        DB --> API: Success
        API --> App: 200 OK
        App --> User: Display "Heated Seat Activated"
    else Command Failed
        API --> App: 503 Service Unavailable
        App --> User: Display "Command Failed. Please try again."
    end

else Open Trunk / Frunk (FR-RMC-008)

    User -> App: Taps "Open Frunk"
    App -> API: POST /vehicles/{id}/command\n{"command": "open_frunk"}

    alt Successful Command
        API -> API: Validate request and send command to vehicle
        API -> DB: UPDATE vehicles SET frunk_open = true WHERE id = ?
        DB --> API: Success
        API --> App: 200 OK
        App --> User: Display "Frunk is Open"
    else Command Failed
        API --> App: 400 Bad Request (e.g., vehicle is moving)
        App --> User: Display "Cannot open while vehicle is in motion."
    end

else Honk Horn / Flash Lights (FR-RMC-009)

    User -> App: Taps "Honk & Flash"
    App -> API: POST /vehicles/{id}/command\n{"command": "honk_flash"}

    alt Successful Command
        API -> API: Validate request and send command to vehicle
        API --> App: 200 OK
        App --> User: Display "Horn & Lights Activated"
    else Command Failed
        API --> App: 503 Service Unavailable
        App --> User: Display "Command Failed. Please try again."
    end

end
@enduml